(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{43:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);n(35);var r=n(0),c=n.n(r),s=n(8),a=n.n(s),o=n(31),i=n.n(o),u=(n(43),n(11)),l=n(2),d=n(7),j=n(6),p=n.n(j),b=n(3),g=n(77),f=n(80),O=n(78),h=n(79),x=n(32),v=n.n(x),y=n(18),k=n.p+"static/media/marker.8a6e5ca6.svg",m="https://ip.skycoin.com/batch",w="http://localhost:9081/map",_=n(33),S=n.n(_).a.create({headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true","Content-Type":"application/json"}}),P=function(){var e=Object(u.a)(p.a.mark((function e(t){var n,r,c,s,a,o,i,u,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.nodes,r=t.edges,null!==n&&null!==r){e.next=3;break}throw new Error("nodes and edges are null");case 3:return c=[],s=new Map,a=Object.keys(n),e.next=8,C(a);case 8:o=e.sent,i=function(e){if(void 0===n[e])return"continue";var t={id:e,title:e,x:o[e].latitude,y:o[e].longitude,public_keys:n[e].public_keys};n[e].public_keys.forEach((function(t){s.set(t,e)})),c.push(t)},e.t0=p.a.keys(o);case 11:if((e.t1=e.t0()).done){e.next=18;break}if(u=e.t1.value,"continue"!==i(u)){e.next=16;break}return e.abrupt("continue",11);case 16:e.next=11;break;case 18:return l=r.map((function(e){return{handleTooltipText:"Source : ".concat(e.edges[0]," \n Target : ").concat(e.edges[1]),sourcePKey:e.edges[0],targetPKey:e.edges[1],t_id:e.t_id,t_type:e.type,t_label:e.label,source:s.get(e.edges[0]),target:s.get(e.edges[1])}})),e.abrupt("return",{nodes:c,edges:l,pkeyMap:s});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function C(e){return M.apply(this,arguments)}function M(){return(M=Object(u.a)(p.a.mark((function e(t){var n,r,c,s,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=T(t,300),r={},c=0;case 3:if(!(c<n.length)){e.next=13;break}return s={ips:n[c]},a=JSON.stringify(s),e.next=8,S.post(m,a);case 8:e.sent.data.result.forEach((function(e){r[e.ip_address]=e}));case 10:c++,e.next=3;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t){for(var n=e.length,r=new Array(Math.ceil(n/t)),c=0,s=0;c<n;)r[s++]=e.slice(c,c+=t);return r}function L(){return E.apply(this,arguments)}function E(){return(E=Object(u.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,e.next=4,S.get(w).then((function(e){t=e.data}));case 4:return e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var I=n(1),K=function(e){var t=e.edge;return Object(I.jsxs)("div",{id:"node-info",children:[Object(I.jsx)("h2",{children:"Transport"}),Object(I.jsx)("p",{className:"tt",children:t.t_id}),Object(I.jsx)("strong",{children:"Source IP:"}),t.source,Object(I.jsx)("br",{}),Object(I.jsx)("strong",{children:"Source IP:"}),t.source,Object(I.jsx)("br",{}),Object(I.jsx)("strong",{children:"Target IP:"}),t.target,Object(I.jsx)("br",{}),Object(I.jsx)("strong",{children:"Transport Type::"}),t.t_type,Object(I.jsx)("br",{}),Object(I.jsx)("strong",{children:"Transport Label:"}),t.t_label,Object(I.jsx)("br",{}),Object(I.jsx)("strong",{children:"Source Visor:"}),Object(I.jsx)("p",{children:t.sourcePKey}),Object(I.jsx)("strong",{children:"Target Visor:"}),Object(I.jsx)("p",{children:t.targetPKey}),Object(I.jsx)("br",{})]})},A=function(){var e=new b.Icon({iconUrl:k,iconSize:[25,25]}),t=Object(r.useState)(!1),n=Object(d.a)(t,2),c=n[0],s=n[1];function a(){s(!c)}var o=Object(r.useState)(!1),i=Object(d.a)(o,2),j=i[0],x=i[1],m=Object(r.useState)(void 0),w=Object(d.a)(m,2),_=w[0],S=w[1],C=Object(r.useState)({loading:!1,errMsg:"",selected:{node:void 0,edges:void 0},preprocessedResult:{nodes:[],edges:[],pkeyMap:new Map}}),M=Object(d.a)(C,2),T=M[0],E=M[1];function A(){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(Object(l.a)(Object(l.a)({},T),{},{loading:!0}));try{L().then((function(e){P(e).then((function(e){E(Object(l.a)(Object(l.a)({},T),{},{preprocessedResult:e}))}))}))}catch(t){E(Object(l.a)(Object(l.a)({},T),{},{errMsg:t,loading:!1}))}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){var r,c=null===(r=T.selected.node)||void 0===r?void 0:r.public_keys;if(void 0===c)return!1;for(var s=0;s<c.length;s++)if(e.sourcePKey===c[s]||e.targetPKey===c[s])return!0;return!1}Object(r.useEffect)((function(){A().catch((function(e){return E(Object(l.a)(Object(l.a)({},T),{},{errMsg:e,loading:!1}))})),x(!0)}),[]),Object(r.useEffect)((function(){var e=setInterval((function(){A().catch((function(e){return E(Object(l.a)(Object(l.a)({},T),{},{errMsg:e,loading:!1}))}))}),3e5);return function(){return clearInterval(e)}}),[j]);var N=new b.LatLng(-90,-180),R=new b.LatLng(90,180),z=function(e){if(void 0!==T.selected.edges){var t=T.selected.edges.filter((function(t,n,r){return t.sourcePKey===e||t.targetPKey===e}));return t.length>0?(S(t[0]),function(e){return a()}):function(e){}}};return Object(I.jsxs)(r.Fragment,{children:[Object(I.jsxs)(g.a,{zoom:3,center:[45,90],scrollWheelZoom:!1,bounds:new b.LatLngBounds(N,R),maxBounds:new b.LatLngBounds(N,R),children:[Object(I.jsx)(f.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),T.preprocessedResult.nodes.map((function(t){return Object(I.jsx)(O.a,{position:[t.x,t.y],eventHandlers:{click:function(e){var n=T.preprocessedResult.edges.filter(F);console.log("EDGES: ",n),E(Object(l.a)(Object(l.a)({},T),{},{selected:{node:t,edges:n}}))}},icon:e,children:Object(I.jsx)(h.a,{children:Object(I.jsxs)("div",{className:"map-popup",children:[Object(I.jsx)("h3",{children:"Visors"}),Object(I.jsx)("ul",{children:void 0!==t.public_keys&&t.public_keys.length>0?(n=t.public_keys,n.map((function(e,t){return Object(I.jsx)("li",{onClick:z(e),children:e})}))):Object(I.jsx)("p",{children:"Empty"})}),void 0!==_?Object(I.jsx)(v.a,{isOpen:c,onRequestClose:a,className:"edge-modal",overlayClassName:"edge-overlay",preventScroll:!1,children:Object(I.jsx)(K,{edge:_})}):Object(I.jsx)("div",{})]})})},t.id);var n}))]}),""!==T.errMsg?Object(y.a)({error:T.errMsg,position:"top-right",autoClose:5e3,closeOnClick:!0,pauseOnHover:!0,draggable:!0}):Object(I.jsx)("div",{}),T.loading?Object(y.a)({info:"loading data",position:"top-right",dismiss:T.loading}):Object(I.jsx)("div",{})]})};i.a.config();var B=function(){return Object(I.jsx)("div",{children:Object(I.jsx)(A,{})})},F=(n(74),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,81)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),s(e),a(e)}))});a.a.render(Object(I.jsx)(c.a.StrictMode,{children:Object(I.jsx)(B,{})}),document.getElementById("root")),F()}},[[75,1,2]]]);
//# sourceMappingURL=main.588f2c65.chunk.js.map